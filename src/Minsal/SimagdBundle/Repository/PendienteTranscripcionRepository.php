<?php

namespace Minsal\SimagdBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * PendienteTranscripcionRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PendienteTranscripcionRepository extends EntityRepository
{
    /*
     * **************************************************************************
     * Asignar transcriptor a elementos de lista
     * **************************************************************************
     */
    public function addToWorkList($id_estabLocal, $id_trcX, $id_empUsserAssign, $rows = array())
    {
        /*
         * QueryBuilder
         */
        $qb = $this->getEntityManager()->createQueryBuilder();
        /*
         * Query
         */
        $q  = $qb->update('MinsalSimagdBundle:ImgPendienteTranscripcion', 'pndT')
                    ->set('pndT.idTranscriptorAsignado', $qb->expr()->literal($id_trcX))
                    ->set('pndT.idAsignaTranscriptor', $qb->expr()->literal($id_empUsserAssign))
                    ->where('pndT.idEstablecimiento = :id_est_pndT')
                    ->setParameter('id_est_pndT', $id_estabLocal)
                    ->andWhere('pndT.id IN (:pndT_rows_affected)')
                    ->setParameter('pndT_rows_affected', $rows)
                ->getQuery();
        /*
         * execute query
         */
        $p = $q->execute();
    }
}
