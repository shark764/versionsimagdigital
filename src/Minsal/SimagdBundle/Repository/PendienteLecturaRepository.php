<?php

namespace Minsal\SimagdBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * PendienteLecturaRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PendienteLecturaRepository extends EntityRepository
{
    /*
     * **************************************************************************
     * Asignar radiÃ³logo a elementos de lista
     * **************************************************************************
     */
    public function addToWorkList($id_estabLocal, $id_radX, $id_empUsserAssign, $rows = array())
    {
        /*
         * QueryBuilder
         */
        $qb = $this->getEntityManager()->createQueryBuilder();
        /*
         * Query
         */
        $q  = $qb->update('MinsalSimagdBundle:ImgPendienteLectura', 'pndL')
                    ->set('pndL.idRadiologoAsignado', $qb->expr()->literal($id_radX))
                    ->set('pndL.idAsignaRadiologo', $qb->expr()->literal($id_empUsserAssign))
                    ->where('pndL.idEstablecimiento = :id_est_pndL')
                    ->setParameter('id_est_pndL', $id_estabLocal)
                    ->andWhere('pndL.id IN (:pndL_rows_affected)')
                    ->setParameter('pndL_rows_affected', $rows)
                ->getQuery();
        /*
         * execute query
         */
        $p = $q->execute();
    }
}
