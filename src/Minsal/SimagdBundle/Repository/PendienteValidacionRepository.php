<?php

namespace Minsal\SimagdBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * PendienteValidacionRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class PendienteValidacionRepository extends EntityRepository
{
    /*
     * **************************************************************************
     * Asignar radiÃ³logo a elementos de lista
     * **************************************************************************
     */
    public function asignarElementoListaTrabajo($id_estabLocal, $id_radX, $id_empUsserAssign, $rows = array())
    {
        /*
         * QueryBuilder
         */
        $qb = $this->getEntityManager()->createQueryBuilder();
        /*
         * Query
         */
        $q  = $qb->update('MinsalSimagdBundle:ImgPendienteValidacion', 'pndV')
                    ->set('pndV.idRadiologoAsignado', $qb->expr()->literal($id_radX))
                    ->set('pndV.idAsignaValidador', $qb->expr()->literal($id_empUsserAssign))
                    ->where('pndV.idEstablecimiento = :id_est_pndV')
                    ->setParameter('id_est_pndV', $id_estabLocal)
                    ->andWhere('pndV.id IN (:pndV_rows_affected)')
                    ->setParameter('pndV_rows_affected', $rows)
                ->getQuery();
        /*
         * execute query
         */
        $p = $q->execute();
    }
}
