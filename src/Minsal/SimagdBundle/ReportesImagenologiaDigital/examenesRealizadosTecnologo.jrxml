<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="examenesRealizadosTecnologo" language="groovy" pageWidth="792" pageHeight="612" orientation="Landscape" columnWidth="752" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" uuid="3ee33519-b135-4f5e-825d-3a2d1d608241">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<property name="ireport.jasperserver.reportUnit" value="/simagd/examenesRealizadosTecnologo"/>
	<property name="ireport.jasperserver.url" value="http://localhost:8080/jasperserver/services/repository"/>
	<parameter name="fechaIni" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="fechaFin" class="java.lang.String">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="establecimiento" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="tecnologo" class="java.lang.Integer">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[SELECT mex.numero as numeroexp, (coalesce(mp.primer_nombre ||' '||
mp.segundo_nombre ||' '|| coalesce(mp.tercer_nombre, '') ||' '|| mp.primer_apellido ||' '|| mp.segundo_apellido
 ||' '|| coalesce(mp.apellido_casada, ''))) as nombre,asap.nombrearea as modalidad,prz.fecha as fecha, prz.nombre_estado as estado , memp.nombreempleado as nombremedico, stdprc.nombre as origen, ar.nombre as procedencia, atn.nombre as servicio FROM img_solicitud_estudio pin INNER JOIN
(select  imgpr.id_tecnologo_realiza,imgpr.id_solicitud_estudio,epr.nombre_estado,(case when imgpr.fecha_realizado is not null
then imgpr.fecha_realizado else imgpr.fecha_almacenado end) as fecha  from img_procedimiento_realizado imgpr inner join img_ctl_estado_procedimiento_realizado epr
on imgpr.id_estado_procedimiento_realizado = epr.id where (imgpr.id_estado_procedimiento_realizado = 3 OR imgpr.id_estado_procedimiento_realizado = 5)
and ((imgpr.fecha_realizado between to_date($P{fechaIni},'DD-MM-YYYY') and to_date($P{fechaFin},'DD-MM-YYYY')) OR (imgpr.fecha_almacenado between to_date($P{fechaIni},'DD-MM-YYYY') and to_date($P{fechaFin},'DD-MM-YYYY')) )) as prz
on pin.id = prz.id_solicitud_estudio
inner join ctl_area_servicio_diagnostico asap on pin.id_area_servicio_diagnostico = asap.id
inner join mnt_expediente mex on mex.id = pin.id_expediente
inner join mnt_paciente mp on mex.id_paciente = mp.id
inner join mnt_aten_area_mod_estab aams on aams.id = pin.id_aten_area_mod_estab
inner join ctl_establecimiento stdprc on stdprc.id = aams.id_establecimiento
inner join ctl_atencion atn on atn.id = aams.id_atencion
inner join mnt_area_mod_estab ams on ams.id = aams.id_area_mod_estab
inner join ctl_area_atencion ar on ar.id = ams.id_area_atencion
inner join mnt_empleado memp on memp.id = prz.id_tecnologo_realiza
where pin.id_establecimiento_referido = $P{establecimiento} and prz.id_tecnologo_realiza = $P{tecnologo}  order by nombre,fecha]]>
	</queryString>
	<field name="numeroexp" class="java.lang.String"/>
	<field name="nombre" class="java.lang.String">
		<fieldDescription><![CDATA[Nombre del área de atención]]></fieldDescription>
	</field>
	<field name="modalidad" class="java.lang.String"/>
	<field name="fecha" class="java.sql.Timestamp">
		<fieldDescription><![CDATA[Fecha de la cita medica]]></fieldDescription>
	</field>
	<field name="estado" class="java.lang.String">
		<fieldDescription><![CDATA[Nombre del estado de la cita]]></fieldDescription>
	</field>
	<field name="nombremedico" class="java.lang.String"/>
	<field name="origen" class="java.lang.String"/>
	<field name="procedencia" class="java.lang.String"/>
	<field name="servicio" class="java.lang.String">
		<fieldDescription><![CDATA[Servicio hopitalario al que sera referido si es de ingreso medico]]></fieldDescription>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="129" splitType="Stretch">
			<staticText>
				<reportElement x="161" y="29" width="416" height="15" uuid="7ef244f8-d0a4-4d2c-bd10-504dbe30a19c"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[Sistema Nacional de Salud]]></text>
			</staticText>
			<staticText>
				<reportElement x="161" y="14" width="416" height="15" uuid="ad1fc5a7-ebbb-46c8-af17-76a7cfa189cf"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[República de El Salvador]]></text>
			</staticText>
			<image>
				<reportElement x="13" y="1" width="400" height="85" uuid="1252c2a8-2ce6-4209-a776-855433b63d6e"/>
				<imageExpression><![CDATA["repo:escudo.jpg"]]></imageExpression>
			</image>
			<image>
				<reportElement x="577" y="3" width="175" height="83" uuid="eb64f88e-08bf-477e-982b-0c8a850ec1a3"/>
				<imageExpression><![CDATA["repo:logo_minsal.jpg"]]></imageExpression>
			</image>
			<textField>
				<reportElement x="161" y="42" width="415" height="36" uuid="42dbe407-76dc-4b93-979d-7a2e4668ab0b"/>
				<textElement textAlignment="Center">
					<font size="12" isBold="true"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{origen}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="444" y="97" width="100" height="20" uuid="49d10014-7cb6-4ec3-b367-021739d0603c"/>
				<textFieldExpression><![CDATA[$P{fechaFin}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="392" y="97" width="52" height="20" uuid="8b6ccc71-f029-4b0b-9f0e-bbf28191eeef"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Hasta :]]></text>
			</staticText>
			<staticText>
				<reportElement x="214" y="78" width="330" height="16" uuid="50600164-4cc1-4428-b7de-bbcaf1e896c1"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font fontName="Serif" size="11" isBold="true" isItalic="false" isUnderline="true"/>
				</textElement>
				<text><![CDATA[Examenes Realizados por Tecnologo]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="305" y="97" width="74" height="20" uuid="25bfb10c-198e-4632-96ae-3aca2025ae96"/>
				<textElement>
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{fechaIni}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="253" y="97" width="52" height="20" uuid="ce5b86cb-717d-4c87-bbaf-198efd97bfa8"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Desde :]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band height="35" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="79" height="20" uuid="8cbeafab-190e-4b14-b40c-82a3b77fe1f4"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Tecnologo :]]></text>
			</staticText>
			<textField>
				<reportElement x="79" y="0" width="100" height="20" uuid="dcbd4837-5608-476e-b88d-3e8db2928280"/>
				<textFieldExpression><![CDATA[$F{nombremedico}]]></textFieldExpression>
			</textField>
		</band>
	</pageHeader>
	<columnHeader>
		<band height="42" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="0" width="69" height="20" uuid="b7452b55-6fda-44b9-8bf0-377598b76fe3"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[NEC]]></text>
			</staticText>
			<staticText>
				<reportElement x="69" y="0" width="100" height="20" uuid="63bae20e-971b-46d4-9902-a7f7acf9d52c"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Nombre]]></text>
			</staticText>
			<staticText>
				<reportElement x="169" y="0" width="100" height="20" uuid="d5667d6b-783e-4078-9e28-eb933162eb4c"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Modalidad]]></text>
			</staticText>
			<staticText>
				<reportElement x="269" y="0" width="84" height="20" uuid="544ce133-5684-48e3-a3cc-f64cdb78e9ac"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Fecha]]></text>
			</staticText>
			<staticText>
				<reportElement x="361" y="0" width="83" height="20" uuid="4802ffab-add5-4030-8b8a-7dbfa742b4f5"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Estado]]></text>
			</staticText>
			<staticText>
				<reportElement x="450" y="0" width="100" height="20" uuid="567b74c2-a466-4224-be9f-a49bcea07806"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Origen]]></text>
			</staticText>
			<staticText>
				<reportElement x="569" y="0" width="100" height="20" uuid="5734320a-6b32-4d61-b2e0-f07d3750e69d"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Procedencia]]></text>
			</staticText>
			<staticText>
				<reportElement x="669" y="0" width="83" height="28" uuid="2051001b-e4de-4216-a8a7-ea9ebabeb885"/>
				<textElement>
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Servicio Hospitalario]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="24" width="752" height="4" uuid="855ecf6e-0e65-496c-8337-560ea51a9e2a"/>
			</line>
		</band>
	</columnHeader>
	<detail>
		<band height="50" splitType="Stretch">
			<textField>
				<reportElement x="0" y="0" width="69" height="20" uuid="b817b652-fbc5-412f-ab0e-7b77c2f4a25f"/>
				<textFieldExpression><![CDATA[$F{numeroexp}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="69" y="0" width="100" height="47" uuid="607d59c5-05f5-4d83-b2e8-7478c01be9f8"/>
				<textFieldExpression><![CDATA[$F{nombre}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="169" y="0" width="100" height="20" uuid="18acc0d4-3cab-4fa7-9a25-77d6babce5f5"/>
				<textFieldExpression><![CDATA[$F{modalidad}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy">
				<reportElement x="269" y="0" width="84" height="20" uuid="d6cc5877-72e7-41f8-811d-98eeb19baa69"/>
				<textFieldExpression><![CDATA[$F{fecha}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="361" y="0" width="83" height="20" uuid="972994f0-4d22-4594-a7f2-e57eab23f207"/>
				<textFieldExpression><![CDATA[$F{estado}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="450" y="0" width="100" height="47" uuid="83faafe5-a38f-4b74-8b56-b3d35a5ec108"/>
				<textFieldExpression><![CDATA[$F{origen}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="569" y="0" width="100" height="20" uuid="4008d3dd-8d08-4601-8667-f7d9abb58a4e"/>
				<textFieldExpression><![CDATA[$F{procedencia}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="669" y="0" width="83" height="47" uuid="6deed531-9224-4b71-a420-7a2c199018f9"/>
				<textFieldExpression><![CDATA[$F{servicio}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band height="25" splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="24" splitType="Stretch">
			<textField evaluationTime="Report">
				<reportElement x="711" y="0" width="40" height="20" uuid="1cd08b08-1cb6-4bb4-93e7-22ce8f3c559b"/>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="432" y="0" width="279" height="20" uuid="9fb76430-d8cf-457e-8f8a-14bfd6e8fc9d"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression><![CDATA["Pagina "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField pattern="EEE, d MMM yyyy K:mm:ss a">
				<reportElement x="2" y="0" width="159" height="20" uuid="ac46d6b9-9d65-4acc-84ca-e3971a1e7453"/>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
	<summary>
		<band height="23" splitType="Stretch"/>
	</summary>
</jasperReport>
