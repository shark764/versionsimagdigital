{# empty Twig template #}

{% extends 'SonataAdminBundle:CRUD:base_list.html.twig' %}

{% block stylesheets %}
    {{ parent() }}

    {# stylesheets minimized with Assetic #}
    {% stylesheets
        'bundles/minsalsimagd/css/simagd-styles.css'
        'bundles/minsalsimagd/css/simagd-form-styles.css'
        'bundles/minsalsimagd/css/simagd-extend-bootstrap3.css'
        'bundles/minsalsimagd/css/simagd-extend-bootstrap3_minsalsiaps.css'
        'bundles/minsalsimagd/css/simagd-table.css'

        'bundles/minsalsimagd/css/typeahead.css'
        'bundles/minsalsimagd/css/select2-bootstrap.css'
        'bundles/minsalsimagd/css/select2-bootstrap_minsalsiaps.css'

        output="bundles/minsalsimagd/compiled/css/bundle_stylesheets___layout.css" %}
        <link href="{{ asset_url }}" type="text/css" rel="stylesheet" />
    {% endstylesheets %}
    
    {# simagd-styles
    <link href="{{ asset('bundles/minsalsimagd/css/simagd-styles.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsimagd/css/simagd-form-styles.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsimagd/css/simagd-extend-bootstrap3.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsimagd/css/simagd-table.css') }}" type="text/css" rel="stylesheet" /> #}
    
    {# Bootstrap-calendar #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-datetimepicker-development/build/css/bootstrap-datetimepicker.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# iCheck #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/icheck-1.x/skins/minimal/aero.css') }}" type="text/css" rel="stylesheet" />
    
    {# Twitter Typeahead #}
    <link href="{{ asset('bundles/minsalsimagd/css/typeahead.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-table #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-table-master/dist/bootstrap-table.min.css') }}" type="text/css" rel="stylesheet" media="screen" />
    
    {# formValidation #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/formvalidation-master/dist/css/formValidation.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# toastmessage #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/akquinet-jquery-toastmessage-plugin-6f5d7bf/src/main/resources/css/jquery.toastmessage.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-modal #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-modal-master/css/bootstrap-modal-bs3patch.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-modal-master/css/bootstrap-modal.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-vertical-tabs #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-vertical-tabs-1.2.2/bootstrap.vertical-tabs.css') }}" type="text/css" rel="stylesheet" />
    
    {# bootstrap-switch #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-switch-master/dist/css/bootstrap3/bootstrap-switch.min.css') }}" type="text/css" rel="stylesheet" />
    
    {# select2-bootstrap #}
    <link href="{{ asset('bundles/minsalsimagd/css/select2-bootstrap.css') }}" type="text/css" rel="stylesheet" />

    {# Bootstrap-Colorpicker #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/bootstrap-colorpicker-master/dist/css/bootstrap-colorpicker.min.css') }}" type="text/css" rel="stylesheet" />
    {# colorpicker #}
    <link href="{{ asset('bundles/minsalsimagd/css/colorpicker.css') }}" type="text/css" rel="stylesheet" />

    {# bootstrap text-editor summernote #}
    <link href="{{ asset('bundles/minsalsimagd/plugin/summernote-master/dist/summernote.css') }}" type="text/css" rel="stylesheet" />
    <link href="{{ asset('bundles/minsalsimagd/css/summernote.css') }}" type="text/css" rel="stylesheet" />
{% endblock %}

{% block javascripts %}
    {{ parent() }}

    <script>
        window.__GLOBAL_ADMIN_CONFIGURATION__ = {
            ADMIN_UNIQID_TOKEN: '{{ admin.uniqId }}',
            CURRENT_ACTION_FORM: {% if action is defined %}'{{ action }}'{% else %}'menu'{% endif %},
            ID_USERLOGGED: {{ app.user.getId()|escape('js') }},
            ID_USERLOGGED_EMPLOYEE: {% if app.user.getIdEmpleado() is not null %}{{ app.user.getIdEmpleado().getId()|escape('js') }}{% else %}false{% endif %},
            COD_USERLOGGED_EMPLOYEE: {% if app.user.getIdEmpleado() is not null %}'{{ app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo()|escape('js') }}'{% else %}false{% endif %},
            ID_USERLOGGED_ESTAB: {% if app.user.getIdEstablecimiento() is not null %}{{ app.user.getIdEstablecimiento().getId()|escape('js') }}{% else %}false{% endif %}
        };
        window.__GLOBAL_BUNDLE_CONFIGURATION__ = {
            IS_USERLOGGED_ADMIN: {% if is_granted('ROLE_ADMIN') %}true{% else %}false{% endif %},
            IS_USERLOGGED_RADX: {% if is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_LECTURA_CREATE') and (app.user.getIdEmpleado() is not null and app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo() == 'MRY') %}true{% else %}false{% endif %},
            IS_USERLOGGED_PRCMED: {% if is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_SOLICITUD_ESTUDIO_CREATE') and (app.user.getIdEmpleado() is not null and app.user.getIdEmpleado().getIdTipoEmpleado().getCodigo() == 'MED') %}true{% else %}false{% endif %}
        };
    </script>

    {# select2-es #}
    <script type="text/javascript" src="{{ asset('/bundles/sonataadmin/vendor/select2/select2_locale_es.js') }}" ></script>
    
    {# iCheck #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/icheck-1.x/icheck.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_form_configuration.js') }}" ></script>
    
    {# jquery-ui #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/jquery-ui-1.12.1.custom/jquery-ui.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_highlight_error_ui.js') }}" ></script>

    {# jquery-formparams #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/jquery.formparams.min.js') }}" ></script>

    {# jquery-maskedinput #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/jquery.mask.min.js') }}" ></script>
    
    {# Simagd extend jQuery #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_jQueryCustomFunctions.js') }}" ></script>
    
    {# Twitter Typeahead #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/typeahead.js-master/dist/typeahead.bundle.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/typeahead.js-master/dist/bloodhound.js') }}" ></script>
    
    {# bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-table-master/dist/bootstrap-table.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-table-master/dist/locale/bootstrap-table-es-CR.min.js') }}" ></script>
    {# data format for bootstrap-table #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_data_bsTable_formatter.js') }}" ></script>
    {# filters for bootstrap-table #}
    {#<script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_filter_bstable_configuration.js') }}" ></script>#}
    
    {# Bootstrap-calendar #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/moment-develop/min/moment-with-locales.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-datetimepicker-development/build/js/bootstrap-datetimepicker.min.js') }}" ></script>
    
    {# Simagd Custom Scripts #}
    {#<script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_personal_formplugin.js') }}" ></script>#}
    {#<script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_init_formplugin.js') }}" ></script>#}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_form_configuration_v2.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_configuration_alert.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_setterObject_modalData.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/js/simagd_select2_custom_formatter.js') }}" ></script>
    
    {# Patologia Custom Scripts #}
    {#<script type="text/javascript" src="{{ asset('bundles/minsalpatologia/js/patlg_edittemplate_bsform_configuration.js') }}" ></script>#}
    
    {# formValidation #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/formvalidation-master/dist/js/formValidation.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/formvalidation-master/dist/js/framework/bootstrap.min.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/formvalidation-master/dist/js/language/es_ES.js') }}" ></script>
    
    {# toastmessage #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/akquinet-jquery-toastmessage-plugin-6f5d7bf/src/main/javascript/jquery.toastmessage.js') }}" ></script>
    
    {# bootstrap-modal #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-modal-master/js/bootstrap-modalmanager.js') }}" ></script>
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-modal-master/js/bootstrap-modal.js') }}" ></script>
    
    {# bootstrap-switch #}
    <script type="text/javascript" src="{{ asset('bundles/minsalsimagd/plugin/bootstrap-switch-master/dist/js/bootstrap-switch.min.js') }}" ></script>

    <script type="text/javascript">
        ////////////////////////////////////////////////////////////////
        //////// clear form
        ////////////////////////////////////////////////////////////////
        clearForm = function(el) {
            $form = jQuery(el).closest('form');
            $form.data('formValidation').resetForm();
            $form.get(0).reset();
            $form
                .find('select')
                    .each(function () {
                        var $select2    = jQuery(this);
                        $select2.select2('val', $select2.find(':selected').val());
                    });
        }
        ////////////////////////////////////////////////////////////////

        jQuery.extend(true,
                window.Admin,
                {
                    setup_select2: function(subject) {
                        if (window.SONATA_CONFIG && window.SONATA_CONFIG.USE_SELECT2 && window.Select2) {

                            jQuery('select:not([data-sonata-select2="false"])', subject).each(function() {
                                var select = $(this);

                                var allowClearEnabled = false;

                                if (select.find('option[value=""]').length) {
                                    allowClearEnabled = true;
                                }

                                if (select.attr('data-sonata-select2-allow-clear')==='true') {
                                    allowClearEnabled = true;
                                } else if (select.attr('data-sonata-select2-allow-clear')==='false') {
                                    allowClearEnabled = false;
                                }

                                __select2_options__ = {
                                    width: 'resolve',
                                    minimumResultsForSearch: 10,
                                    // dropdownAutoWidth : true,
                                    allowClear: allowClearEnabled
                                };

                                //////// escapeMarkup
                                if (select.attr('data-sonata-select2-escape-markup')==='true') {
                                    jQuery.extend(true,
                                        __select2_options__,
                                        {
                                            escapeMarkup: function(markup) {
                                                return markup;
                                            }
                                        }
                                    );
                                }
                                ////////

                                //////// width
                                // if (select.attr('data-sonata-select2-limit-width')==='true') {
                                //     jQuery.extend(true,
                                //         __select2_options__,
                                //         {
                                //             width: '75%'
                                //         }
                                //     );
                                // }
                                ////////

                                //////// initialize with custom options
                                select.select2(__select2_options__);
                                ////////

                                var popover = select.data('popover');

                                if (undefined !== popover) {
                                    select
                                        .select2('container')
                                        .popover(popover.options)
                                    ;
                                }
                            });
                        }
                    }
                }
        ); // set value for filter
    </script>
{% endblock %}



{% block sonata_breadcrumb %} {% endblock sonata_breadcrumb %}{# #}

{% block actions %} {% endblock %}{# #}

{% block tab_menu %} {% endblock %}{# #}


    
{% block content %}
    {{ parent() }}

    <div class="col-lg-8 col-md-8 col-sm-8 col-xs-offset-2{# #}">
        <div class="row"> <!-- row block -->
            <div class="box box-drop-outside-shadow {#box-dark-theme#} box-primary-v4">
                <div class="box-body">

                    <ul class="nav nav-pills nav-justified">
                        <li class="active"><a href="javascript:void(0)" onclick="generate(this, 'unrealized_procedures'); return false;" data-toggle="pill">Examinar</a></li>
                        <li><a href="javascript:void(0)" onclick="generate(this, 'undiagnosed_studies'); return false;" data-toggle="pill">Lectura</a></li>
                        <li><a href="javascript:void(0)" onclick="generate(this, 'non_transcribed_results'); return false;" data-toggle="pill">Transcripción</a></li>
                        <li><a href="javascript:void(0)" onclick="generate(this, 'non_validated_results'); return false;" data-toggle="pill">Revisión</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="tab-pane fade in active" id="tab_list__" >

        <!-- 
        //////////////////////////////////////////////////////////////
        //////// TABLE
        //////////////////////////////////////////////////////////////
         -->
        <!-- table for any result -->
        <div class="col-lg-12 col-md-12 col-sm-12{# #}">
            <table class="table table-condensed" id="ryx_target_bstable" name="ryx_target_bstable" {#data-toggle="table" #}>
                <thead>
                </thead>
            </table>
        </div>
        <!-- end table -->
        <!-- 
        //////////////////////////////////////////////////////////////
        //////// END --| TABLE
        //////////////////////////////////////////////////////////////
         -->

    </div>

    <!-- 
    //////////////////////////////////////////////////////////////
    //////// SCRIPT FUNCTIONS
    //////////////////////////////////////////////////////////////
     -->
    <script type="text/javascript">
        generate = function(el, slug, type = null) {
            ////////
            var $table = jQuery('#ryx_target_bstable');
            ////////
            $table.bootstrapTable('showLoading');

            $url = null;
            if (slug === 'unrealized_procedures') {
                $url = 'simagd_sin_realizar_generateTable';
            }
            if (slug === 'undiagnosed_studies') {
                $url = 'simagd_sin_lectura_generateTable';
            }
            if (slug === 'non_transcribed_results') {
                $url = 'simagd_sin_transcribir_generateTable';
            }
            if (slug === 'non_validated_results') {
                $url = 'simagd_sin_validar_generateTable';
            }

            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: Routing.generate($url),
                data: {
                    id: 'id',
                    slug: slug,
                    type: type
                },
                success: function(response) {
                    $table
                        .bootstrapTable('destroy')
                        .bootstrapTable(response.options);
                },
                error: function(err) {
                    console.log(err.error, err.responseText);
                }
            });
        }

        destroy = function(el) {
            if (jQuery(el).attr('id') !== "undefined" && (jQuery(el).attr('id') === "pry2" || jQuery(el).attr('id') === "pry4")) {
                var $table = jQuery('#ryx_target_bstable');
                $table.bootstrapTable('destroy');
            }
        }

        function patientFormatResult(el) {
            var markup = '<div class="row-fluid">' +
                                // '<div class="span2"><img src="' + el.owner.avatar_url + '" /></div>' +
                                '<div class="span10">' +
                                '<div class="row-fluid">' +
                                '<div class="span6">' + el.full_name + '</div>' +
                                // '<div class="span3"><i class="fa fa-code-fork"></i> ' + el.forks_count + '</div>' +
                                // '<div class="span3"><i class="fa fa-star"></i> ' + el.stargazers_count + '</div>' +
                            '</div>';

            // if (el.description) {
            //     markup += '<div>' + el.description + '</div>';
            // }

            markup += '</div></div>';

            return markup;
        }

        function patientFormatSelection(el) {
            return el.full_name;
        }

        function displaySelection(data)
        {
            var jt = [];
            if (!data.t || !parseInt(data.t, 10)) {
                jt.push('<div class="jumbotron">');
            }
            else {
                jt.push('<div class="jumbotron" style="background-color: #ebc5b9;">');
            }
            jt.push('<div class="container">', '<h2><strong><span class="text-primary-v4">', data.item.full_name, '</span></strong></h2>');
            if (!data.t || !parseInt(data.t, 10)) {
                jt.push('<strong><span class="badge badge-primary-v4" style="font-size: 25px;">', data.item.numero, '</span></strong>');
            }
            else {
                jt.push('<strong><span class="badge badge-emergency" style="font-size: 25px;">', data.item.numero, '</span></strong>');
            }
            jt.push('<p><a class="btn btn-primary-v4 " role="button">Crear solicitud</a></p>');
            jt.push('</div>', '</div>');
            return jt.join('');
        }
    </script>
    <!-- 
    //////////////////////////////////////////////////////////////
    //////// END --| SCRIPT FUNCTIONS
    //////////////////////////////////////////////////////////////
     -->

    {% include 'MinsalSimagdBundle:CRUD:simagd_edit_orm_modal.html.twig' ignore missing with {'id': 'patient_modal_search_'} %}
    
{% endblock %}

{% block list_table %} {% endblock %}

{% block list_filters %} {% endblock %}