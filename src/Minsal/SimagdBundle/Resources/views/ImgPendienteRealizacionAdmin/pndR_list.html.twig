{# empty Twig template #}

{% extends 'MinsalSimagdBundle::simagd_base_list.html.twig' %}

{% set _minWarning = 10 %}
{% set _minDanger = 8 %}

{% block javascripts %}
    {{ parent() }}

    {% include 'MinsalSimagdBundle:ImagenologiaDigitalAdmin:simagd_proximaConsulta.js.twig'
                                    ignore missing with { '_msjTitle': 'Lista de trabajo:',
                                                            '_minWarning': _minWarning,
                                                            '_minDanger': _minDanger,
                                                         } %}
{% endblock %}

{% block actions %}
    {% spaceless %}
        <li>{% include 'MinsalSimagdBundle:ImgPendienteRealizacionAdmin:pndR_ir_a_miLista_button.html.twig' %}</li>
    {% endspaceless %}
{% endblock %}

{% block simagd_form_navbar_brand_title %}
    {% set _adminTitle = admin.hasRoute('registrarEnMiLista') ? 'Listado de exámenes pendientes' : '<i class="fa fa-user"></i> Listado personal de exámenes pendientes' %}
    <span class="navbar-brand"><span class="label label-primary-v2"> <i class="fa fa-desktop"></i> <i class="fa fa-list-ul"></i> {{ _adminTitle|raw }} </span></span>
{% endblock %}

{% block table_body %}
    <tbody>

        {% set _showPendienteRow = false %}
        
	{% if is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_PROCEDIMIENTO_REALIZADO_CREATE') or
                    is_granted('ROLE_MINSAL_SIMAGD_ADMIN_IMG_PROCEDIMIENTO_REALIZADO_EDIT') or is_granted('ROLE_ADMIN') %}

            {% set _showPendienteRow = true %}

	{% endif %}

        {% for object in admin.datagrid.results %}
        
            {% if _showPendienteRow %}

                {% set _proximaConsulta = object.idSolicitudEstudio.fechaProximaConsulta %}
                {% set _proximaConsultaTitle = 'Próxima consulta médica:\n' ~ _proximaConsulta|format_date('EEEE, MMMM d, yyyy', 'es_ES') %}

                {% include 'MinsalSimagdBundle:ImagenologiaDigitalAdmin:simagd_rowFechaPendiente.html.twig'
                                ignore missing with { '_proximaConsulta': _proximaConsulta,
                                                        '_proximaConsultaTitle': _proximaConsultaTitle,
                                                        '_warningRow': _minWarning,
                                                        '_dangerRow': _minDanger,
                                                     } %}
        
            {% else %}
                <tr>
            {% endif %}
        
                {% include admin.getTemplate('inner_list_row') %}
            </tr>
        {% endfor %}
    
    </tbody>
{% endblock %}