{% autoescape false %}

	<script type="text/javascript">
        var _fn_show_object_detail = function(el, slug, id) {
            window.alert(slug + '\n' + id);
        }

        var generate = function(el, slug, emrg/* = 0, type = 'list'*/) {
			if (emrg === undefined) {
		        emrg = 0;
		    }
            ////////
            var $table = jQuery('#ryx_target_bstable');
            ////////
            $table.bootstrapTable('showLoading');

            $url = null;
			switch (slug) {
				case 'study_request':
				case 'emergency_study_request':
					$url = 'simagd_solicitud_estudio_generateTable';
					break;
				case 'diagnostic_request':
					$url = 'simagd_solicitud_diagnostico_generateTable';
					break;
				case 'further_study_request':
					$url = 'simagd_solicitud_estudio_complementario_generateTable';
					break;
				default:
					break;
			}

            var type = jQuery('input[name=_request_dashboard_display_type]:checked').val();

            $.ajax({
                type: 'POST',
                dataType: 'json',
                url: Routing.generate($url),
                data: {
                    _xml_http_request: true,
                    id: 'id',
                    slug: slug,
                    type: type,
                    emrg: emrg,
                },
                success: function(response) {
                    ////////
                    $table
                        .bootstrapTable('destroy')
                        .bootstrapTable(response.options);
                    ////////
                },
                error: function(err) {
                    console.log(err.error, err.responseText);
                }
            });
        }

        jQuery(document).ready(function() {
            /*
             *
             * @type type
             * Get Table definition
             */
             // generate(null, 'study_request');
             // jQuery('#')

            //////
            var $table = jQuery('#ryx_target_bstable');
            ////////
            // $table.bootstrapTable('showLoading');

            ////////
            var DEFAULT_TABLE_OPTIONS = JSON.parse('{{ DEFAULT_TABLE_OPTIONS|json_encode|e('js')|raw }}');

            $table
                .bootstrapTable('destroy')
                .bootstrapTable(DEFAULT_TABLE_OPTIONS);
            ////////


            //////////////////////////////////////////////////////////////////////////
            //////// change content type - worklist
            //////////////////////////////////////////////////////////////////////////
            var __DOM__worklistDisplayType = jQuery('input[name=_request_dashboard_display_type]');

            __DOM__worklistDisplayType.on('ifChecked', function(e) {

                        jQuery('#_request_dashboard_display_items li.active').find('a').triggerHandler('click');

            });
            //////////////////////////////////////////////////////////////////////////
            //////////////////////////////////////////////////////////////////////////

			// jQuery('#_switch_display').iCheck('destroy').bootstrapSwitch();
        });

        /////////////////////////////////////////////////////
        //////// STUDY REQUEST - CONTEXT MENU
        /////////////////////////////////////////////////////
        (function ($) {
            /*
             *
             * @type Array
             * Global variables for plugin
             */
            window.__STUDYREQUEST_MENU_ACTIONEVENTS__ = {
                'click .studyrequest_show_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_show', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_edit_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_edit', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_delete_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_checkmedicalhistory_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_medicalhistory', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_showallrequest_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var record_number = row.exp_id;
                    if (row.is_external !== false) {
                        record_number = row.xexp_id;
                    }
                    var url = Routing.generate('simagd_solicitud_estudio_patienthistory', {id: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_studydownload_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_create_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .studyrequest_createtothispatient_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, preview: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
            };   // --| build data collection

        }(jQuery));

        /////////////////////////////////////////////////////
        //////// EMERGENCY STUDY REQUEST - CONTEXT MENU
        /////////////////////////////////////////////////////
        (function ($) {
            /*
             *
             * @type Array
             * Global variables for plugin
             */
            window.__EMERGENCYSTUDYREQUEST_MENU_ACTIONEVENTS__ = {
                'click .emergencystudyrequest_show_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_show', {id: row.id, emergency: true, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_edit_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_edit', {id: row.id, emergency: true, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_delete_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, emergency: true, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_showallrequest_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var record_number = row.exp_id;
                    if (row.is_external !== false) {
                        record_number = row.xexp_id;
                    }
                    var url = Routing.generate('simagd_solicitud_estudio_patienthistory', {id: row.id, emergency: true, record: record_number, is_external: row.is_external, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_studydownload_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_create_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, emergency: true, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .emergencystudyrequest_createtothispatient_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, preview: row.id, emergency: true, record: record_number, is_external: row.is_external, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
            };   // --| build data collection

        }(jQuery));

        /////////////////////////////////////////////////////
        //////// DIAGNOSTIC REQUEST - CONTEXT MENU
        /////////////////////////////////////////////////////
        (function ($) {
            /*
             *
             * @type Array
             * Global variables for plugin
             */
            window.__DIAGNOSTICREQUEST_MENU_ACTIONEVENTS__ = {
                'click .diagnosticrequest_show_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_show', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .diagnosticrequest_edit_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_edit', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .diagnosticrequest_delete_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .diagnosticrequest_studydownload_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .diagnosticrequest_create_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_create', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .diagnosticrequest_addtothis_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_diagnostico_create', {id: row.id, preview: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
            };   // --| build data collection

        }(jQuery));

        /////////////////////////////////////////////////////
        //////// FURTHER STUDY REQUEST - CONTEXT MENU
        /////////////////////////////////////////////////////
        (function ($) {
            /*
             *
             * @type Array
             * Global variables for plugin
             */
            window.__FURTHERSTUDYREQUEST_MENU_ACTIONEVENTS__ = {
                'click .furtherstudyrequest_show_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_complementario_show', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .furtherstudyrequest_edit_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_complementario_edit', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .furtherstudyrequest_delete_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_complementario_delete', {id: row.id, confirmation: false});
                    // window.location.href = url; // simulate link click
                },
                'click .furtherstudyrequest_studydownload_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_lectura_show', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .furtherstudyrequest_create_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_complementario_create', {id: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
                'click .furtherstudyrequest_addtothis_action': function (e, value, row, index) {
                    window.console.log(e, value, row, index);
                    var url = Routing.generate('simagd_solicitud_estudio_complementario_create', {id: row.id, preview: row.id, mode: 'standard'});
                    // window.location.href = url; // simulate link click
                },
            };   // --| build data collection

        }(jQuery));

        (function ($) {
            /*
             *
             * @type Array
             * Global variables for plugin
             */
            window.__FUNCTIONS_CALL__ = {};   // --| build data collection

            /*
             * Collection of functions / fc options
             */
            __FUNCTIONS_CALL__.functions = {
                onContextMenuItem: function(row, $el) {
                    /////////////////////////////////////////////////////
                    //////// STUDY REQUEST - CONTEXT MENU
                    /////////////////////////////////////////////////////
                    if($el.data('item') === 'studyrequest_show')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_show', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'studyrequest_edit')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_edit', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'studyrequest_delete')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'studyrequest_checkmedicalhistory')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_medicalhistory', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'studyrequest_showallrequest')
                    {
                        var record_number = row.exp_id;
                        if (row.is_external !== false) {
                            record_number = row.xexp_id;
                        }
                        var url = Routing.generate('simagd_solicitud_estudio_patienthistory', {id: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    }
                    else if($el.data('item') === 'studyrequest_studydownload')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'studyrequest_create')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'studyrequest_createtothispatient')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, preview: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    }

                    /////////////////////////////////////////////////////
                    //////// EMERGENCY STUDY REQUEST - CONTEXT MENU
                    /////////////////////////////////////////////////////
                    else if($el.data('item') === 'emergencystudyrequest_show')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_show', {id: row.id, emergency: true, mode: 'standard'});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_edit')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_edit', {id: row.id, emergency: true, mode: 'standard'});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_delete')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, emergency: true, confirmation: false});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_showallrequest')
                    {
                        var record_number = row.exp_id;
                        if (row.is_external !== false) {
                            record_number = row.xexp_id;
                        }
                        var url = Routing.generate('simagd_solicitud_estudio_patienthistory', {id: row.id, emergency: true, record: record_number, is_external: row.is_external, mode: 'standard'});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_studydownload')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_create')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_delete', {id: row.id, emergency: true, mode: 'standard'});
                    }
                    else if($el.data('item') === 'emergencystudyrequest_createtothispatient')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_create', {id: row.id, preview: row.id, emergency: true, record: record_number, is_external: row.is_external, mode: 'standard'});
                    }

                    /////////////////////////////////////////////////////
                    //////// DIAGNOSTIC REQUEST - CONTEXT MENU
                    /////////////////////////////////////////////////////
                    else if($el.data('item') === 'diagnosticrequest_show')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_show', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'diagnosticrequest_edit')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_edit', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'diagnosticrequest_delete')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'diagnosticrequest_studydownload')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'diagnosticrequest_create')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_create', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'diagnosticrequest_addtothis')
                    {
                        var url = Routing.generate('simagd_solicitud_diagnostico_create', {id: row.id, preview: row.id, record: record_number, is_external: row.is_external, mode: 'standard'});
                    }

                    /////////////////////////////////////////////////////
                    //////// FURTHER STUDY REQUEST - CONTEXT MENU
                    /////////////////////////////////////////////////////
                    else if($el.data('item') === 'furtherstudyrequest_show')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_complementario_show', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'furtherstudyrequest_edit')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_complementario_edit', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'furtherstudyrequest_delete')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_complementario_delete', {id: row.id, confirmation: false});
                    }
                    else if($el.data('item') === 'furtherstudyrequest_studydownload')
                    {
                        var url = Routing.generate('simagd_lectura_show', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'furtherstudyrequest_create')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_complementario_create', {id: row.id, mode: 'standard'});
                    }
                    else if($el.data('item') === 'furtherstudyrequest_addtothis')
                    {
                        var url = Routing.generate('simagd_solicitud_estudio_complementario_create', {id: row.id, preview: row.id, mode: 'standard'});
                    }
                    // end
                },
            };  // --| build function object

        }(jQuery));

    </script>

{% endautoescape %}